<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERP Q&A Flow Builder v2</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        erp: {
                            50: '#f0fdf9',
                            100: '#ccfbf1',
                            500: '#14b8a6',
                            600: '#0d9488',
                            700: '#0f766e',
                            primary: '#3aa992',
                            dark: '#1e293b'
                        }
                    }
                }
            }
        }
    </script>

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>

    <style>
        .bg-grid {
            background-size: 20px 20px;
            background-image:
                    linear-gradient(to right, #e2e8f0 1px, transparent 1px),
                    linear-gradient(to bottom, #e2e8f0 1px, transparent 1px);
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Animation for node entry */
        @keyframes popIn {
            0% { transform: scale(0.9); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .node-enter {
            animation: popIn 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
    </style>
</head>
<body class="bg-gray-50 h-screen overflow-hidden text-slate-800 font-sans" x-data="flowBuilder()">

<header class="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-6 z-50 relative shadow-sm">
    <div class="flex items-center gap-4">
        <h1 class="text-xl font-bold text-slate-800">Q&A Flow Designer</h1>
        <span class="bg-erp-100 text-erp-700 text-xs px-2 py-1 rounded-full font-medium">Marketing Module</span>
    </div>
    <div class="flex gap-3">
        <button @click="clearCanvas()" class="px-4 py-2 text-sm text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors">Alles Wissen</button>
        <button @click="saveFlow()" class="px-4 py-2 bg-erp-primary text-white rounded-md text-sm font-medium hover:bg-erp-600 shadow-sm transition-colors">
            Flow Opslaan
        </button>
    </div>
</header>

<div class="flex h-[calc(100vh-64px)]">

    <aside class="w-64 bg-white border-r border-gray-200 flex flex-col z-40 shadow-sm select-none">
        <div class="p-4 border-b border-gray-100">
            <h2 class="text-xs font-bold text-gray-400 uppercase tracking-wider">Vraag Types</h2>
            <p class="text-xs text-gray-400 mt-1">Sleep naar het canvas</p>
        </div>

        <div class="flex-1 overflow-y-auto p-4 space-y-3">
            <template x-for="type in nodeTypes" :key="type.id">
                <div draggable="true"
                     @dragstart="startDrag($event, type)"
                     class="flex items-center gap-3 p-3 bg-white border border-gray-200 rounded-lg cursor-grab hover:border-erp-primary hover:shadow-md transition-all group active:cursor-grabbing">
                    <div class="w-8 h-8 rounded bg-gray-50 flex items-center justify-center text-gray-500 group-hover:text-erp-primary">
                        <span x-html="type.icon"></span>
                    </div>
                    <span class="text-sm font-medium text-gray-700" x-text="type.label"></span>
                </div>
            </template>
        </div>
    </aside>

    <main class="flex-1 relative bg-gray-50 overflow-hidden"
          @dragover.prevent
          @drop.prevent="drop($event)"
          @mousedown.self="startPan($event)"
          @mousemove="handleMouseMove($event)"
          @mouseup="stopDragOrPan()">

        <div class="absolute inset-0 bg-grid transform origin-top-left cursor-move"
             :style="`transform: translate(${pan.x}px, ${pan.y}px) scale(${zoom})`">

            <svg class="absolute top-0 left-0 w-[5000px] h-[5000px] pointer-events-none overflow-visible z-0">
                <template x-for="conn in connections" :key="conn.id">
                    <path :d="getPath(conn)"
                          stroke="#cbd5e1"
                          stroke-width="3"
                          fill="none"
                          class="transition-all duration-75" />
                </template>

                <path x-show="drawingConnection"
                      :d="tempPath"
                      stroke="#3aa992"
                      stroke-width="3"
                      stroke-dasharray="5,5"
                      fill="none" />
            </svg>

            <template x-for="node in nodes" :key="node.id">
                <div class="absolute w-72 bg-white rounded-lg shadow-lg border border-gray-200 flex flex-col group node-enter"
                     :class="{'ring-2 ring-erp-primary shadow-xl': selectedNode?.id === node.id}"
                     :style="`left: ${node.x}px; top: ${node.y}px; cursor: default;`"
                     @mousedown="selectNode(node)">

                    <div class="h-3 rounded-t-lg bg-gray-100 border-b border-gray-200 group-hover:bg-erp-primary/10 cursor-move transition-colors flex justify-end px-2 items-center"
                         @mousedown.stop="startNodeDrag($event, node)">
                        <button @click.stop="deleteNode(node.id)" class="text-gray-400 hover:text-red-500 font-bold text-lg leading-none">&times;</button>
                    </div>

                    <div class="p-4">
                        <span class="text-[10px] font-bold text-erp-primary uppercase tracking-wider mb-1 block" x-text="node.typeLabel"></span>

                        <h3 class="text-sm font-semibold text-gray-800 mb-2 line-clamp-2 min-h-[1.25rem]"
                            x-text="node.data.question || 'Klik om vraag in te stellen...'"></h3>

                        <template x-if="node.type === 'file_input'">
                            <div class="w-full h-20 border-2 border-dashed border-gray-300 rounded bg-gray-50 flex flex-col items-center justify-center text-center p-2 group-hover:border-erp-primary/50 transition-colors">
                                <svg class="w-6 h-6 text-gray-400 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                                <span class="text-[10px] text-gray-500">Sleep bestanden hierheen<br>of klik om te uploaden</span>
                            </div>
                        </template>

                        <template x-if="['multiple_choice', 'checkbox'].includes(node.type)">
                            <div class="space-y-1">
                                <template x-for="opt in node.data.options.slice(0, 3)" :key="opt">
                                    <div class="flex items-center gap-2">
                                        <div class="w-3 h-3 rounded-full border border-gray-300 bg-white"></div>
                                        <div class="h-2 bg-gray-100 rounded w-3/4"></div>
                                    </div>
                                </template>
                                <div x-show="node.data.options.length > 3" class="text-[10px] text-gray-400 pl-5">... en meer</div>
                            </div>
                        </template>

                        <template x-if="node.type === 'condition'">
                            <div class="bg-amber-50 border border-amber-100 rounded p-2 text-xs text-amber-800">
                                <span class="font-bold">Als:</span>
                                <span x-text="node.data.conditionType || '...'"></span>
                                <span x-text="node.data.conditionValue ? `'${node.data.conditionValue}'` : '...'"></span>
                            </div>
                        </template>

                        <p class="text-[10px] text-gray-400 mt-2 text-right" x-show="node.data.required">* Verplicht</p>
                    </div>

                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 w-6 h-6 bg-white border-2 border-gray-300 rounded-full flex items-center justify-center cursor-crosshair hover:border-erp-primary hover:scale-110 transition-transform z-10 shadow-sm"
                         title="Sleep hierheen om te verbinden"
                         @mouseup="completeConnection(node.id)">
                        <div class="w-1.5 h-1.5 bg-gray-400 rounded-full"></div>
                    </div>

                    <div class="absolute -bottom-3 left-1/2 transform -translate-x-1/2 w-6 h-6 bg-white border-2 border-erp-primary rounded-full flex items-center justify-center cursor-crosshair hover:bg-erp-50 hover:scale-110 transition-transform z-10 shadow-sm"
                         title="Sleep om een verbinding te maken"
                         @mousedown.stop="startConnectionDrag($event, node.id)">
                        <div class="w-2 h-2 bg-erp-primary rounded-full"></div>
                    </div>
                </div>
            </template>
        </div>

        <div class="absolute bottom-6 left-6 flex bg-white rounded-md shadow border border-gray-200 z-30">
            <button @click="zoom = Math.max(0.5, zoom - 0.1)" class="px-3 py-1 text-gray-600 hover:bg-gray-50 border-r">-</button>
            <span class="px-2 py-1 text-xs text-gray-500 flex items-center min-w-[3rem] justify-center" x-text="Math.round(zoom * 100) + '%'"></span>
            <button @click="zoom = Math.min(2, zoom + 0.1)" class="px-3 py-1 text-gray-600 hover:bg-gray-50 border-l">+</button>
        </div>

        <div class="absolute bottom-6 right-6 text-xs text-gray-400 pointer-events-none">
            Space/Drag om te pannen &bull; Scroll om te zoomen
        </div>
    </main>

    <aside class="w-80 bg-white border-l border-gray-200 z-50 shadow-2xl transform transition-transform duration-300 overflow-y-auto"
           :class="selectedNode ? 'translate-x-0' : 'translate-x-full'">

        <div class="p-5" x-if="selectedNode">
            <div class="flex justify-between items-center mb-6 pb-4 border-b border-gray-100">
                <h2 class="text-lg font-bold text-gray-800">Eigenschappen</h2>
                <button @click="selectedNode = null" class="text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 p-1">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>

            <div class="space-y-5">
                <div x-show="selectedNode.type !== 'condition'">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Vraagstelling</label>
                    <textarea x-model="selectedNode.data.question" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-erp-primary focus:border-transparent text-sm transition-shadow" placeholder="Typ hier de vraag voor de klant..."></textarea>
                </div>

                <div x-show="selectedNode.type !== 'condition'">
                    <label class="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" x-model="selectedNode.data.required" class="w-4 h-4 text-erp-primary border-gray-300 rounded focus:ring-erp-primary">
                        <span class="text-sm text-gray-700">Antwoord verplicht stellen</span>
                    </label>
                </div>

                <hr class="border-gray-100">

                <template x-if="['multiple_choice', 'multi_select', 'checkbox'].includes(selectedNode.type)">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Antwoord Opties</label>
                        <div class="space-y-2 mb-3">
                            <template x-for="(opt, index) in selectedNode.data.options" :key="index">
                                <div class="flex gap-2 items-center group">
                                    <span class="text-xs text-gray-400 w-4" x-text="index + 1 + '.'"></span>
                                    <input type="text" x-model="selectedNode.data.options[index]" class="flex-1 px-3 py-2 border border-gray-300 rounded text-sm focus:border-erp-primary focus:outline-none">
                                    <button @click="selectedNode.data.options.splice(index, 1)" class="text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                                    </button>
                                </div>
                            </template>
                        </div>
                        <button @click="selectedNode.data.options.push('')" class="w-full py-2 border border-dashed border-erp-primary text-erp-primary rounded text-sm font-medium hover:bg-erp-50 transition-colors">
                            + Optie toevoegen
                        </button>
                    </div>
                </template>

                <template x-if="selectedNode.type === 'file_input'">
                    <div class="bg-gray-50 p-3 rounded border border-gray-200 space-y-3">
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Toegestane Bestanden</label>
                            <div class="flex flex-wrap gap-2">
                                <label class="inline-flex items-center"><input type="checkbox" class="rounded text-erp-primary border-gray-300 mr-1"><span class="text-sm">PDF</span></label>
                                <label class="inline-flex items-center"><input type="checkbox" class="rounded text-erp-primary border-gray-300 mr-1"><span class="text-sm">Afbeeldingen (JPG/PNG)</span></label>
                                <label class="inline-flex items-center"><input type="checkbox" class="rounded text-erp-primary border-gray-300 mr-1"><span class="text-sm">Word/Excel</span></label>
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Max Grootte (MB)</label>
                            <input type="number" value="5" class="w-20 px-2 py-1 border border-gray-300 rounded text-sm">
                        </div>
                    </div>
                </template>

                <template x-if="selectedNode.type === 'condition'">
                    <div class="bg-amber-50 p-4 rounded border border-amber-100">
                        <p class="text-xs text-amber-700 mb-3">Stel een conditie in op basis van het antwoord op de vorige vraag.</p>

                        <div class="space-y-3">
                            <div>
                                <label class="block text-xs font-bold text-amber-800 uppercase mb-1">Operator</label>
                                <select x-model="selectedNode.data.conditionType" class="w-full px-3 py-2 border border-amber-200 rounded text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white">
                                    <option value="equals">Gelijk aan</option>
                                    <option value="contains">Bevat</option>
                                    <option value="gt">Groter dan (>)</option>
                                    <option value="gte">Groter dan of gelijk aan (>=)</option>
                                    <option value="lt">Kleiner dan (<)</option>
                                    <option value="lte">Kleiner dan of gelijk aan (<=)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-amber-800 uppercase mb-1">Waarde</label>
                                <input type="text" x-model="selectedNode.data.conditionValue" class="w-full px-3 py-2 border border-amber-200 rounded text-sm focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="Bijv: 'Ja' of '10'">
                            </div>
                        </div>
                    </div>
                </template>

            </div>

            <div class="mt-10 pt-4 border-t border-gray-100">
                <button @click="deleteNode(selectedNode.id)" class="w-full flex items-center justify-center gap-2 bg-white border border-red-200 text-red-600 py-2.5 rounded hover:bg-red-50 hover:border-red-300 transition-colors shadow-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                    Verwijder deze Node
                </button>
            </div>
        </div>

        <div class="h-full flex flex-col items-center justify-center text-gray-400 p-6 text-center" x-show="!selectedNode">
            <svg class="w-12 h-12 mb-3 text-gray-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg>
            <p class="text-sm">Selecteer een node op het canvas om de eigenschappen te bewerken.</p>
        </div>
    </aside>

</div>

<script>
    function flowBuilder() {
        return {
            zoom: 1,
            pan: { x: 0, y: 0 },

            nodes: [],
            connections: [],
            nodeTypes: [
                { id: 'multiple_choice', label: 'Multiple Choice', icon: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>' },
                { id: 'multi_select', label: 'Multi Select', icon: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>' },
                { id: 'rating', label: 'Rating', icon: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>' },
                { id: 'sentence', label: 'Sentence / Text', icon: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>' },
                { id: 'condition', label: 'Condition', icon: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg>' },
                { id: 'file_input', label: 'File Input', icon: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg>' }
            ],

            // Interaction State
            selectedNode: null,
            draggedType: null,
            draggingNode: null,
            dragOffset: { x:0, y:0 },
            panning: false,
            panStart: { x:0, y:0 },

            // Connection Drawing State
            drawingConnection: false,
            connectionStartId: null,
            tempPath: '',

            init() {
                // Start Node example
                this.nodes.push({
                    id: 1,
                    type: 'multiple_choice',
                    typeLabel: 'Multiple Choice',
                    x: 100,
                    y: 100,
                    data: {
                        question: 'Waarmee kunnen we u helpen?',
                        required: true,
                        options: ['Support', 'Sales', 'Administratie']
                    }
                });
            },

            startDrag(e, type) {
                this.draggedType = type;
                e.dataTransfer.effectAllowed = 'copy';
            },

            drop(e) {
                if (!this.draggedType) return;
                const rect = e.currentTarget.getBoundingClientRect();
                const x = (e.clientX - rect.left - this.pan.x) / this.zoom;
                const y = (e.clientY - rect.top - this.pan.y) / this.zoom;

                const newNode = {
                    id: Date.now(),
                    type: this.draggedType.id,
                    typeLabel: this.draggedType.label,
                    x: x - 144, // Center horizontally (w-72 is 288px)
                    y: y - 20,
                    data: {
                        question: '',
                        required: false,
                        options: ['Optie 1'],
                        conditionType: 'equals',
                        conditionValue: ''
                    }
                };

                this.nodes.push(newNode);
                this.selectNode(newNode);
                this.draggedType = null;
            },

            startNodeDrag(e, node) {
                this.draggingNode = node;
                this.dragOffset = {
                    x: e.clientX - node.x * this.zoom - this.pan.x,
                    y: e.clientY - node.y * this.zoom - this.pan.y
                };
                this.selectNode(node);
            },

            startPan(e) {
                this.panning = true;
                this.panStart = { x: e.clientX - this.pan.x, y: e.clientY - this.pan.y };
            },

            handleMouseMove(e) {
                const rect = e.currentTarget.getBoundingClientRect();
                const rawX = (e.clientX - rect.left - this.pan.x) / this.zoom;
                const rawY = (e.clientY - rect.top - this.pan.y) / this.zoom;

                if (this.panning) {
                    this.pan.x = e.clientX - this.panStart.x;
                    this.pan.y = e.clientY - this.panStart.y;
                }
                else if (this.draggingNode) {
                    this.draggingNode.x = (e.clientX - this.dragOffset.x - this.pan.x) / this.zoom;
                    this.draggingNode.y = (e.clientY - this.dragOffset.y - this.pan.y) / this.zoom;
                }
                else if (this.drawingConnection) {
                    const startNode = this.nodes.find(n => n.id === this.connectionStartId);
                    if(startNode) {
                        // Calculate anchor points
                        const startX = startNode.x + 144;
                        // Dynamic height estimation based on content is hard in plain JS without resize observers,
                        // so we assume standard anchor bottom roughly.
                        // In real app: use refs to get exact DOM height.
                        const startY = startNode.y + 120; // Approx bottom
                        this.tempPath = this.calculateBezier(startX, startY, rawX, rawY);
                    }
                }
            },

            stopDragOrPan() {
                this.panning = false;
                this.draggingNode = null;
                if (this.drawingConnection) {
                    this.drawingConnection = false;
                    this.tempPath = '';
                }
            },

            startConnectionDrag(e, nodeId) {
                this.drawingConnection = true;
                this.connectionStartId = nodeId;
            },

            completeConnection(targetNodeId) {
                if (this.drawingConnection && this.connectionStartId !== targetNodeId) {
                    const exists = this.connections.some(c => c.from === this.connectionStartId && c.to === targetNodeId);
                    if (!exists) {
                        this.connections.push({
                            id: Date.now(),
                            from: this.connectionStartId,
                            to: targetNodeId
                        });
                    }
                }
                this.drawingConnection = false;
                this.tempPath = '';
            },

            getPath(conn) {
                const fromNode = this.nodes.find(n => n.id === conn.from);
                const toNode = this.nodes.find(n => n.id === conn.to);
                if (!fromNode || !toNode) return '';

                // In a perfect world, we calculate exact height of DOM element.
                // Here we use approximations for the prototype.
                const startX = fromNode.x + 144;
                const startY = fromNode.y + 140; // Approx bottom of a populated card
                const endX = toNode.x + 144;
                const endY = toNode.y - 12;

                return this.calculateBezier(startX, startY, endX, endY);
            },

            calculateBezier(x1, y1, x2, y2) {
                const dist = Math.abs(y2 - y1);
                const controlOffset = Math.max(dist * 0.5, 50);
                return `M ${x1} ${y1} C ${x1} ${y1 + controlOffset}, ${x2} ${y2 - controlOffset}, ${x2} ${y2}`;
            },

            selectNode(node) {
                this.selectedNode = node;
            },

            deleteNode(id) {
                this.nodes = this.nodes.filter(n => n.id !== id);
                this.connections = this.connections.filter(c => c.from !== id && c.to !== id);
                if (this.selectedNode?.id === id) this.selectedNode = null;
            },

            clearCanvas() {
                if(confirm('Weet u zeker dat u alles wilt wissen?')) {
                    this.nodes = [];
                    this.connections = [];
                    this.selectedNode = null;
                }
            },

            saveFlow() {
                const payload = {
                    nodes: this.nodes,
                    connections: this.connections
                };
                console.log("Saved Data:", payload);
                alert(`Flow opgeslagen! (${this.nodes.length} nodes, ${this.connections.length} connecties) Check console voor JSON.`);
            }
        }
    }
</script>
</body>
</html>